\chapter{Group Actions}

\section{Group Actions and Permutation Representations}

Let $G$ be a group and let $A$ be a nonempty set.

\Exercise1
\label{exercise:group-action:stab-b-conjugate-stab-a}
Let $G$ act on the set $A$. Prove that if $a,b\in A$ and
$b = g\cdot a$ for some $g\in G$, then $G_b = gG_ag^{-1}$ ($G_a$ is
the stabilizer of $a$). Deduce that if $G$ acts transitively on $A$
then the kernel of the action is $\bigcap_{g\in G} gG_ag^{-1}$.
\begin{proof}
  Suppose $a,b\in A$ with $b = g\cdot a$ for some $g\in G$. If
  $h\in G_b$, then $h\cdot b = b$. So
  \begin{align*}
    (g^{-1}hg)\cdot a
    &= (g^{-1}h)\cdot(g\cdot a) \\
    &= g^{-1}\cdot(h\cdot b) \\
    &= g^{-1}\cdot b \\
    &= a,
  \end{align*}
  and we have $g^{-1}hg\in G_a$. Letting $k = g^{-1}hg$, we see that
  $h = gkg^{-1}$ where $k\in G_a$. This shows that
  $G_b\subseteq gG_ag^{-1}$.

  On the other hand, if $h\in gG_ag^{-1}$, then there is a $k\in G_a$
  with $h = gkg^{-1}$. Then
  \begin{align*}
    h\cdot b
    &= (gkg^{-1})\cdot b \\
    &= (gk)\cdot(g^{-1}\cdot b) \\
    &= (gk)\cdot a \\
    &= g\cdot(k\cdot a) \\
    &= g\cdot a \\
    &= b,
  \end{align*}
  so $h\in G_b$. This completes the proof that $G_b = gG_ag^{-1}$.

  We know that the kernel of the action is the set of elements of $G$
  which stabilize every point in $A$. If the action is transitive,
  then for any $a,b\in A$ there is some $g\in G$ such that
  $G_b = gG_ag^{-1}$, as has already been proved. Thus we can write
  \begin{equation*}
    \bigcap_{g\in G}gG_ag^{-1} = \bigcap_{b\in A}G_b,
  \end{equation*}
  so that the kernel of the action is $\bigcap_{g\in G}gG_ag^{-1}$.
\end{proof}

\Exercise2
\label{exercise:group-action:perm-stab-b-conjugate-stab-a}
Let $G$ be a {\em permutation group} on the set $A$ (i.e.,
$G\leq S_A$), let $\sigma\in G$ and let $a\in A$. Prove that
$\sigma G_a\sigma^{-1} = G_{\sigma(a)}$. Deduce that if $G$ acts
transitively on $A$ then
\begin{equation*}
  \bigcap_{\sigma\in G}\sigma G_a\sigma^{-1} = 1.
\end{equation*}
\begin{proof}
  Since $G$ naturally acts on $A$ via the map
  $\sigma\cdot a\mapsto\sigma(a)$, we know by the previous exercise,
  Exercise~\ref{exercise:group-action:stab-b-conjugate-stab-a}, that
  \begin{equation*}
    G_{\sigma(a)} = \sigma G_a\sigma^{-1}.
  \end{equation*}

  Since $G$ acts faithfully on $A$, the kernel of the action is
  trivial. If the action is also transitive, then (again by the
  previous exercise) we have
  \begin{equation*}
    \bigcap_{\sigma\in G}\sigma G_a\sigma^{-1} = 1. \qedhere
  \end{equation*}
\end{proof}

\Exercise3 Assume that $G$ is an abelian, transitive subgroup of
$S_A$. Show that $\sigma(a) \neq a$ for all $\sigma\in G - \{1\}$ and
all $a\in A$. Deduce that $\ord{G} = \ord{A}$.
\begin{proof}
  Let $a\in A$. Since $G$ is abelian, its subgroups are normal. In
  particular, $\sigma G_a\sigma^{-1} = G_a$. Since $G$ is also
  transitive, we know by the previous exercise,
  Exercise~\ref{exercise:group-action:perm-stab-b-conjugate-stab-a},
  that
  \begin{equation*}
    G_a = \bigcap_{\sigma\in G}\sigma G_a\sigma^{-1} = 1.
  \end{equation*}
  Thus the stabilizer of $a$ is trivial, so $\sigma(a) = a$ if and
  only if $\sigma$ is the identity.

  Finally, since $G$ has only one orbit, we have by Proposition~2 that
  \begin{equation*}
    \ord{G : G_a} = \ord{A}.
  \end{equation*}
  But by Lagrange's Theorem,
  \begin{equation*}
    \ord{G : G_a} = \frac{\ord{G}}{\ord{G_a}} = \ord{G},
  \end{equation*}
  so $\ord{G} = \ord{A}$ as required.
\end{proof}

\Exercise4 Let $S_3$ act on the set $\Omega$ of ordered pairs:
\begin{equation*}
  \{(i,j)\mid1\leq i,j\leq3\} \quad\text{by}\quad
  \sigma((i,j)) = (\sigma(i), \sigma(j)).
\end{equation*}
Find the orbits of $S_3$ on $\Omega$. For each $\sigma\in S_3$ find
the cycle decomposition of $\sigma$ under this action (i.e., find its
cycle decomposition when $\sigma$ is considered as an element of $S_9$
--- first fix a labelling of these nine ordered pairs). For each orbit
$\mathcal{O}$ of $S_3$ acting on these nine points pick some
$a\in\mathcal{O}$ and find the stabilizer of $a$ in $S_3$.
\begin{solution}
  We know $(1,1)$, $(2,2)$, and $(3,3)$ belong to the same orbit since
  \begin{equation*}
    (1\,2)(1,1) = (2,2) \quad\text{and}\quad
    (2\,3)(2,2) = (3,3).
  \end{equation*}
  And these form a complete orbit since if $\sigma(i,i) = (j,k)$ we
  must have $j = k$.

  We also find
  \begin{equation*}
    (1,2)
    \xrightarrow{(1\,2)} (2,1)
    \xrightarrow{(2\,1\,3)} (1,3)
    \xrightarrow{(1\,3)} (3,1)
    \xrightarrow{(1\,2)} (3,2)
    \xrightarrow{(2\,3)} (2,3),
  \end{equation*}
  so the six elements $(1,2)$, $(2,1)$, $(1,3)$, $(3,1)$, $(2,3)$, and
  $(3,2)$ belong to the other orbit.

  Now identify
  \begin{align*}
    \mathbf1 = (1,1), && \mathbf4 = (2,1), && \mathbf7 = (3,1), \\
    \mathbf2 = (1,2), && \mathbf5 = (2,2), && \mathbf8 = (3,2), \\
    \mathbf3 = (1,3), && \mathbf6 = (2,3), && \mathbf9 = (3,3).
  \end{align*}
  We get the following cycle decompositions:
  \begin{align*}
    \sigma_1
    &= (), \\
    \sigma_{(1\,2)}
    &= (\mathbf1\,\mathbf5)(\mathbf2\,\mathbf4)
      (\mathbf3\,\mathbf6)(\mathbf7\,\mathbf8), \\
    \sigma_{(1\,3)}
    &= (\mathbf1\,\mathbf9)(\mathbf2\,\mathbf8)
      (\mathbf3\,\mathbf7)(\mathbf4\,\mathbf6), \\
    \sigma_{(2\,3)}
    &= (\mathbf2\,\mathbf3)(\mathbf4\,\mathbf7)
      (\mathbf5\,\mathbf9)(\mathbf6\,\mathbf8), \\
    \sigma_{(1\,2\,3)}
    &= (\mathbf1\,\mathbf5\,\mathbf9)(\mathbf2\,\mathbf6\,\mathbf7)
      (\mathbf3\,\mathbf4\,\mathbf8), \\
    \intertext{and}
    \sigma_{(1\,3\,2)}
    &= (\mathbf1\,\mathbf9\,\mathbf5)(\mathbf2\,\mathbf7\,\mathbf6)
      (\mathbf3\,\mathbf8\,\mathbf4).
  \end{align*}

  Finally, from the first orbit we may choose $\mathbf1 = (1,1)$. The
  stabilizer of this element is
  \begin{equation*}
    \{1, (2\,3)\}.
  \end{equation*}
  For the remaining orbit, we may choose $\mathbf2 = (1,2)$. The
  stabilizer of this element is the identity.
\end{solution}

\Exercise6 As in Exercise~\ref{exercise:subgroup:poly-integer-coef} of
Section~2.2 let $R$ be the set of all polynomials with integer
coefficients in the independent variables $x_1$, $x_2$, $x_3$, $x_4$
and let $S_4$ act on $R$ by permuting the indices of the four
variables:
\begin{equation*}
  \sigma\cdot p(x_1,x_2,x_3,x_4)
  = p(x_{\sigma(1)},x_{\sigma(2)},x_{\sigma(3)},x_{\sigma(4)})
\end{equation*}
for all $\sigma\in S_4$.
\begin{enumerate}
\item Find the polynomials in the orbit of $S_4$ on $R$ containing
  $x_1 + x_2$.
  \begin{solution}
    We saw in Exercise~\ref{exercise:subgroup:poly-integer-coef} that
    the stabilizer of this polynomial has order $4$. As a subgroup of
    $S_4$, this stabilizer has index
    \begin{equation*}
      \frac{\ord{S_4}}4 = \frac{24}4 = 6.
    \end{equation*}
    By Proposition~2, the number of elements in the orbit
    $\mathcal{O}$ of $S_4$ on $R$ containing $x_1 + x_2$ is $6$. We
    find
    \begin{multline*}
      x_1 + x_2
      \xrightarrow{(1\,3)}
      x_2 + x_3
      \xrightarrow{(2\,4)}
      x_3 + x_4 \\
      \xrightarrow{(1\,3)}
      x_1 + x_4
      \xrightarrow{(3\,4)}
      x_1 + x_3
      \xrightarrow{(1\,2)(3\,4)}
      x_2 + x_4.
    \end{multline*}
    So we see that the orbit $\mathcal{O}$ consists of the above six
    polynomials.
  \end{solution}

\item Find the polynomials in the orbit of $S_4$ on $R$ containing
  $x_1x_2 + x_3x_4$.
  \begin{solution}
    Again by Exercise~\ref{exercise:subgroup:poly-integer-coef}, we
    know that the stabilizer of this polynomial has order $8$. As a
    result the orbit $\mathcal{O}$ containing this polynomial has
    order $24/8 = 3$. We find that this orbit is
    \begin{equation*}
      \mathcal{O} =
      \{x_1x_2 + x_3x_4, x_1x_3 + x_2x_4, x_2x_3 + x_1x_4\}.
      \qedhere
    \end{equation*}
  \end{solution}

\item Find the polynomials in the orbit of $S_4$ on $R$ containing
  $(x_1 + x_2)(x_3 + x_4)$.
  \begin{solution}
    We know by Exercise~\ref{exercise:subgroup:poly-integer-coef} that
    the stabilizer of this polynomial has order $8$. So the orbit
    containing it has order $3$. The orbit is
    \begin{equation*}
      \{(x_1+x_2)(x_3+x_4), (x_1+x_3)(x_2+x_4), (x_1+x_4)(x_2+x_3)\}.
      \qedhere
    \end{equation*}
  \end{solution}
\end{enumerate}

\Exercise7
\label{exercise:group-action:blocks-and-prim}
Let $G$ be a transitive permutation group on the finite set $A$. A
{\em block} is a nonempty subset $B$ of $A$ such that for all
$\sigma\in G$ either $\sigma(B) = B$ or $\sigma(B)\cap B = \emptyset$
(here $\sigma(B)$ is the set $\{\sigma(b)\mid b\in B\}$).
\begin{enumerate}
\item Prove that if $B$ is a block containing the element $a$ of $A$,
  then the set $G_B$ defined by
  $G_B = \{\sigma\in G\mid \sigma(B) = B\}$ is a subgroup of $G$
  containing $G_a$.
  \begin{proof}
    Certainly $1(B) = B$, so $G_B$ is nonempty. Let $\sigma\in
    G_B$. Since $B$ is a block, either $\sigma^{-1}(B) = B$ or
    $\sigma^{-1}(B)\cap B = \emptyset$. But the latter cannot be true
    because, if it were, we would have for any $b\in B$ that
    $\sigma^{-1}(\sigma(b)) = b\not\in B$, which is a
    contradiction. Therefore $\sigma^{-1}\in G_B$ and $G_B$ is closed
    under inverses. And if $\sigma$ and $\tau$ are both in $G_B$, then
    \begin{equation*}
      (\sigma\tau)(B) = \sigma(\tau(B)) = \sigma(B) = B,
    \end{equation*}
    so $\sigma\tau\in G_B$. Thus $G_B\leq G$.

    Finally, since $a\in B$, if $\sigma\in G_a$ then
    $\sigma(a) = a\in B$ so $\sigma(B)$ and $B$ are not disjoint. Thus
    $\sigma\in G_B$ and we see that $G_a\leq G_B$.
  \end{proof}

\item Show that if $B$ is a block and
  $\sigma_1(B), \sigma_2(B), \dots, \sigma_n(B)$ are all the distinct
  images of $B$ under the elements of $G$, then these form a partition
  of $A$.
  \begin{proof}
    Let $a\in A$ and $b\in B$. Since $G$ is transitive, there is
    $\sigma\in G$ with $\sigma(b) = a$. Therefore $a$ belongs to at
    least one of the sets $\sigma_i(B)$, so
    \begin{equation*}
      A = \bigcup_{i=1}^n\sigma_i(B).
    \end{equation*}

    Next we show that the sets $\sigma_i(B)$ are pairwise
    disjoint. Suppose $\sigma_i(B)$ and $\sigma_j(B)$ are not disjoint
    for some $i$ and $j$, and let $a$ be an element belonging to their
    intersection. Then there is $b_1,b_2\in B$ with
    \begin{equation*}
      \sigma_i(b_1) = \sigma_j(b_2) = a.
    \end{equation*}
    So $b_1 = \sigma_i^{-1}\sigma_j(b_2)$. Since $B$ is a block, this
    shows that $\sigma_i^{-1}\sigma_j(B) = B$. This then implies that
    $\sigma_i(B) = \sigma_j(B)$. Since these images are not distinct,
    we must have $i = j$. Therefore the sets are all pairwise
    disjoint.

    Each $\sigma_i(B)$ is nonempty, they are pairwise disjoint, and
    their union is $A$. Therefore these sets form a partition of $A$.
  \end{proof}

\item A (transitive) group $G$ on a set $A$ is said to be {\em
    primitive} if the only blocks in $A$ are the trivial ones: the
  sets of size $1$ and $A$ itself. Show that $S_4$ is primitive on
  $A = \{1,2,3,4\}$. Show that $D_8$ is not primitive as a permutation
  group on the four vertices of a square.
  \begin{proof}
    First we show that $S_4$ is primitive on $A = \{1,2,3,4\}$. If
    not, let $B$ be a nontrivial block. If $B$ has two elements, we
    can without loss of generality assume that $B = \{1,2\}$. Then
    \begin{equation*}
      (1\,3)(B) = \{2,3\}.
    \end{equation*}
    Since $\{2,3\}\neq B$ and $\{2,3\}\cap B\neq\emptyset$, $B$ cannot
    be a block. Similarly, if $B$ has three elements, we may assume
    with full generality that $B = \{1,2,3\}$. Then
    \begin{equation*}
      (1\,4)(B) = \{2,3,4\}
    \end{equation*}
    and for the same reason as before we see that $B$ cannot be a
    block. Therefore the only blocks in $A$ are trivial and $S_4$ is
    primitive.

    Next, to show that $D_8$ is not primitive on the vertices of a
    square, label the vertices $1,2,3,4$ in clockwise fashion so that
    $r$ induces the permutation $(1\,2\,3\,4)$ and $s$ the permutation
    $(2\,4)$. Consider the set
    \begin{equation*}
      B = \{1,3\}.
    \end{equation*}
    For $g\in D_8$, let $\sigma_g$ denote the permutation of
    $\{1,2,3,4\}$ induced by $g$. Then we have
    \begin{align*}
      \sigma_1(B) &= \{1,3\}, & \sigma_s(B) &= \{1,3\}, \\
      \sigma_r(B) &= \{2,4\}, & \sigma_{sr}(B) &= \{2,4\}, \\
      \sigma_{r^2}(B) &= \{1,3\}, & \sigma_{sr^2}(B) &= \{1,3\}, \\
      \sigma_{r^3}(B) &= \{2,4\}, & \sigma_{sr^3}(B) &= \{2,4\}.
    \end{align*}
    In each case, $\sigma(B)$ is either $B$ or is disjoint with $B$,
    so $B$ is a nontrivial block. Therefore $D_8$ is not primitive on
    the vertices of a square.
  \end{proof}

\item Prove that the transitive group $G$ is primitive on $A$ if and
  only if for each $a\in A$, the only subgroups of $G$ containing
  $G_a$ are $G_a$ and $G$ (i.e., $G_a$ is a {\em maximal} subgroup of
  $G$).
  \begin{proof}
    First assume that $G$ is primitive on $A$. Fix an $a\in A$ and let
    $H$ be a subgroup of $G$ containing $G_a$. Define the subset $B$
    of $A$ by
    \begin{equation*}
      B = \{\tau(a)\mid \tau\in H\}.
    \end{equation*}
    Now let $\sigma\in G$ be arbitrary and suppose that $\sigma(B)$
    and $B$ are not disjoint. Let $b\in\sigma(B)\cap B$. Since
    $b\in B$, there is $\tau\in H$ with $\tau(a) = b$. On the other
    hand, since $b\in\sigma(B)$ there is $b_0\in B$ with
    $\sigma(b_0) = b$. We can find $\rho\in H$ with $\rho(a) =
    b_0$. Then
    \begin{equation*}
      \tau(a) = b = \sigma(b_0) = \sigma(\rho(a)).
    \end{equation*}
    In particular, this means that $a = \tau^{-1}\sigma\rho(a)$ and we
    see that $\tau^{-1}\sigma\rho$ is in $G_a$ and hence in $H$. But
    $\tau$ and $\rho^{-1}$ are in $H$, so
    \begin{equation*}
      \tau(\tau^{-1}\sigma\rho)\rho^{-1} = \sigma \in H.
    \end{equation*}

    We will show that, in this case, $B = \sigma(B)$. Choose any
    $b_2\in B$. Then there is $\alpha\in H$ with $\alpha(a) =
    b_2$. Then $\sigma^{-1}\alpha(a) = \sigma^{-1}(b_2)$. Since
    $\sigma^{-1}\alpha\in H$, this implies that
    $\sigma^{-1}(b_2)\in B$. Thus $b_2\in\sigma(B)$. Conversely, if we
    let $b_2\in\sigma(B)$, then there is $b_3\in B$ with
    $\sigma(b_3) = b_2$. We can find $\beta\in H$ with
    $\beta(a) = b_3$, so
    \begin{equation*}
      b_2 = \sigma(b_3) = \sigma\beta(a)
    \end{equation*}
    and we see that $b_2\in B$. Thus $B = \sigma(B)$. We have shown
    that for any $\sigma\in G$, either $B\cap\sigma(B) = \emptyset$ or
    $B = \sigma(B)$. Hence $B$ is a block.

    Now, $G$ is primitive, so the block $B$ must be trivial. Since
    $G_a\leq H$, we know $a\in B$. So if $\ord{B} = 1$ then
    $B = \{a\}$ and we must have $H = G_a$. On the other hand, if
    $B = A$, then given any $\sigma\in G$, we have
    $\sigma(a) = \tau(a)$ for some $\tau\in H$. But then
    $\sigma^{-1}\tau$ belongs to the stabilizer of $a$, and hence
    belongs to $H$. This implies that $\sigma^{-1}$ and thus $\sigma$
    itself belongs to $H$. We conclude that in this case, $H = G$.

    In either case, $H = G_a$ or $H = G$, so $G_a$ is a maximal
    subgroup of $G$.

    Finally, to prove the other direction of implication, take any
    block $B$ of $G$ on $A$ and define
    $G_B = \{\sigma\in G\mid\sigma(B) = B\}$. Pick any $a\in B$. We
    have already shown that $G_B$ is a subgroup of $G$ containing
    $G_a$. Since $G_a$ is maximal, either $G_B = G_a$ or $G_B = G$.

    First, suppose $G_B = G_a$. Choose any $b\in B$. By transitivity,
    there is $\sigma\in G$ with $\sigma(b) = a$. Then $a$ belongs to
    $B\cap\sigma(B)$, so $\sigma(B) = B$ and $\sigma\in G_B$. $\sigma$
    must therefore stabilize $a$, so $b = a$. Thus we see that $B$ is
    the trivial block $\{a\}$.

    Next, suppose $G_B = G$. Let $b\in B$ and, if possible, choose
    $c\in A - B$. Again, by transitivity, we may find $\sigma\in G$
    with $\sigma(b) = c$. But $\sigma\in G_B$, so $\sigma(B) =
    B$. Therefore $c\in B$, and this gives a contradiction. Thus we
    see that $B = A$ and the block $B$ is trivial.

    Since every block in $A$ is trivial, $G$ is primitive on $A$.
  \end{proof}
\end{enumerate}

\Exercise8 A transitive permutation group $G$ on a set $A$ is called
{\em doubly transitive} if for any (hence all) $a\in A$ the subgroup
$G_a$ is transitive on the set $A - \{a\}$.
\begin{enumerate}
\item Prove that $S_n$ is doubly transitive on $\{1, 2, \dots, n\}$
  for all $n\geq2$.
  \begin{proof}
    We already know that $S_n$ acts transitively on
    $A = \{1,2,\dots,n\}$. Fix any $a\in A$. Then $G_a$ simply
    consists of the permutations of the set $A - \{a\}$. That is,
    $G_a$ is isomorphic to $S_{n-1}$. $G_a$ therefore acts
    transitively on $A - \{a\}$, so $S_n$ is doubly transitive.
  \end{proof}

\item Prove that a doubly transitive group is primitive. Deduce that
  $D_8$ is not doubly transitive in its action on the $4$ vertices of
  a square.
  \begin{proof}
    Let $G$ be doubly transitive on $A$ and let $B$ be a block in
    $A$. If $B$ has one element, then it is trivial and we are
    done. So suppose $B$ has at least two distinct elements $a$ and
    $b$. Further, let $c\in A - \{a\}$ be arbitrary. Since $G$ is
    doubly transitive, there is $\sigma\in G_a$ such that
    $\sigma(b) = c$.

    Now, $\sigma(a) = a$, so $\sigma(B)\cap B\neq\emptyset$. And since
    $B$ is a block, this means that $\sigma(B) = B$. Hence
    $c = \sigma(b)\in B$. Therefore $A = B$ and $B$ is again
    trivial. $G$ can have only trivial blocks, so it is primitive by
    definition.

    Lastly, we have already proved in
    Exercise~\ref{exercise:group-action:blocks-and-prim} that $D_8$ is
    not primitive on the vertices of a square. Therefore $D_8$ cannot
    be doubly transitive.
  \end{proof}
\end{enumerate}

\Exercise9 Assume $G$ acts transitively on the finite set $A$ and let
$H$ be a normal subgroup of $G$. Let
$\mathcal{O}_1, \mathcal{O}_2, \dots, \mathcal{O}_r$ be the distinct
orbits of $H$ on $A$.
\begin{enumerate}
\item Prove that $G$ permutes the sets
  $\mathcal{O}_1,\mathcal{O}_2,\dots,\mathcal{O}_r$ in the sense that
  for each $g\in G$ and each $i\in\{1,\dots,r\}$ there is a $j$ such
  that $g\mathcal{O}_i = \mathcal{O}_j$, where
  \begin{equation*}
    g\mathcal{O} = \{g\cdot a \mid a \in \mathcal{O}\}
  \end{equation*}
  (i.e., in the notation of
  Exercise~\ref{exercise:group-action:blocks-and-prim} the sets
  $\mathcal{O}_1,\dots,\mathcal{O}_r$ are blocks). Prove that $G$ is
  transitive on $\{\mathcal{O}_1,\dots,\mathcal{O}_r\}$. Deduce that
  all orbits of $H$ on $A$ have the same cardinality.
  \begin{proof}
    Fix some $g\in G$ and $i\in\{1,\dots,r\}$, and take any
    $a\in\mathcal{O}_i$. Then there is $j$ with
    $g\cdot a\in\mathcal{O}_j$. We want to show that
    $g\mathcal{O}_i = \mathcal{O}_j$.

    Now, $b\in g\mathcal{O}_i$ means that $b = g\cdot c$ for some
    $c\in\mathcal{O}_i$. Since $a$ and $c$ belong to the same orbit of
    $H$, there is $h\in H$ with $c = h\cdot a$. Since $H$ is normal in
    $G$, there is $h_0\in H$ such that $gh = h_0g$ and we get
    \begin{equation*}
      b = g\cdot c = g\cdot(h\cdot a)
      = gh\cdot a = h_0g\cdot a
      = h_0\cdot(g\cdot a) \in \mathcal{O}_j.
    \end{equation*}
    Therefore $g\mathcal{O}_i\subseteq\mathcal{O}_j$. Conversely,
    since $b\in\mathcal{O}_j$ implies that $b$ belongs to the same
    orbit as $g\cdot a$, there is $h_0\in H$ such that
    \begin{equation*}
      b = h_0\cdot(g\cdot a),
    \end{equation*}
    and we see by the same reasoning as above that
    $\mathcal{O}_j\subseteq g\mathcal{O}_i$. Therefore
    $g\mathcal{O}_i = \mathcal{O}_j$.

    So we see that $G$ acts on the orbits of $H$ via the map
    $(g,\mathcal{O}_i)\mapsto g\mathcal{O}_i$. Let $i$ and $j$ in
    $\{1,\dots,r\}$ be arbitrary and choose $a\in\mathcal{O}_i$ and
    $b\in\mathcal{O}_j$. Since $G$ is transitive on $A$, there is
    $g\in G$ with $g\cdot a = b$. From the above we know that
    $g\mathcal{O}_i = \mathcal{O}_j$, so $G$ also acts transitively on
    the orbits of $H$.

    Finally, since $G$ is transitive on the orbits of $H$, there is
    $g\in G$ such that $g\mathcal{O}_i = \mathcal{O}_j$. Then the map
    $\varphi\colon\mathcal{O}_i\to\mathcal{O}_j$ given by
    \begin{equation*}
      \varphi(a) = g\cdot a
    \end{equation*}
    is a bijection, since it admits the inverse
    \begin{equation*}
      \varphi^{-1}(b) = g^{-1}\cdot b.
    \end{equation*}
    Therefore all orbits of $H$ have the same cardinality.
  \end{proof}

\item Prove that if $a\in\mathcal{O}_1$ then
  \begin{equation*}
    \ord{\mathcal{O}_1} = \ord{H : H\cap G_a}
  \end{equation*}
  and prove that
  \begin{equation*}
    r = \ord{G : HG_a}.
  \end{equation*}
  \begin{proof}
    Note that $H\cap G_a$ is just $H_a$, the stabilizer of $a$ in
    $H$. Therefore the first statement follows directly from
    Proposition~2.

    Next, since $H\trianglelefteq G$ we have $G_a\leq N_G(H)$ so by
    the Second Isomorphism Theorem,
    \begin{equation*}
      HG_a/H = G_aH/H \cong G_a/G_a\cap H = G_a/H_a.
    \end{equation*}
    Thus $\ord{HG_a : H} = \ord{G_a : H_a}$. Now, since $G$ is
    transitive on $A$, we again have by Proposition~2 that
    \begin{equation*}
      \ord{A} = \ord{G : G_a}.
    \end{equation*}
    But $r\ord{\mathcal{O}_1} = \ord{A}$, since all orbits of $H$ have
    the same number of elements, so
    \begin{equation*}
      \ord{G : G_a} = r\ord{\mathcal{O}_1} = r\ord{H : H_a}.
    \end{equation*}
    Therefore, making use of
    Exercise~\ref{exercise:quotient-group:subgroup-of-subgroup-index},
    we see that
    \begin{multline*}
      \ord{G : HG_a}
      = \frac{\ord{G : HG_a}\ord{HG_a : H}}{\ord{HG_a : H}}
      = \frac{\ord{G : H}}{\ord{HG_a : H}}
      = \frac{\ord{G : H}}{\ord{G_a : H_a}} \\[3pt]
      = \frac{r\ord{G : H}\ord{H : H_a}}{r\ord{H : H_a}\ord{G_a : H_a}}
      = r\frac{\ord{G : H_a}}{\ord{G : G_a}\ord{G_a : H_a}}
      = r.
    \end{multline*}
    This completes the proof.
  \end{proof}
\end{enumerate}

\Exercise{10} Let $H$ and $K$ be subgroups of the group $G$. For each
$x\in G$ define the $HK$ {\em double coset} of $x$ in $G$ to be the
set
\begin{equation*}
  HxK = \{hxk \mid h\in H, k\in K\}.
\end{equation*}
\begin{enumerate}
\item Prove that $HxK$ is the union of the left cosets
  $x_1K,\dots,x_nK$ where $\{x_1K,\dots,x_nK\}$ is the orbit
  containing $xK$ of $H$ acting by left multiplication on the set of
  left cosets of $K$.
  \begin{proof}
    Let $H$ act by left multiplication on the set of left cosets of
    $K$, so that for $h\in H$, $h\cdot xK = hxK$. Let
    $\{x_1K,\dots,x_nK\}$ be the orbit of $H$ containing $xK$. Define
    \begin{equation*}
      A = \bigcup_{i=1}^nx_iK.
    \end{equation*}
    We want to show that $HxK = A$.

    First let $g\in HxK$ so that $g = hxk$ for some $h\in H$ and
    $k\in K$. Then $g\in hxK = h\cdot xK$. But $h\cdot xK$ is in the
    orbit of $H$ containing $xK$, so $g\in x_jK$ for some $j$. Hence
    $g\in A$.

    Conversely, suppose $g\in A$. Then $g\in x_jK$ for some $j$. Since
    $x_jK$ is in the orbit of $H$ containing $xK$, there is $h\in H$
    such that $h\cdot xK = x_jK$. Then $g\in hxK$ so that $g\in HxK$
    also. Therefore $HxK = A$.
  \end{proof}

\item Prove that $HxK$ is a union of right cosets of $H$.
  \begin{proof}
    The proof is essentially the same as the above, except that we let
    $K$ act on the set of right cosets of $H$ by right
    multiplication. Then if $\{Hx_1,\dots,Hx_n\}$ is the orbit of $K$
    containing $Hx$, we can show that $HxK$ is the union of the right
    cosets in this orbit.
  \end{proof}

\item Show that $HxK$ and $HyK$ are either the same set or are
  disjoint for all $x,y\in G$. Show that the set of $HK$ double cosets
  partitions $G$.
  \begin{proof}
    If $HxK$ and $HyK$ are disjoint, then we are done. Otherwise we
    can take $g\in HxK\cap HyK$. Then there is $h_1,h_2\in H$ and
    $k_1,k_2\in K$ such that
    \begin{equation*}
      h_1xk_1 = g = h_2yk_2,
      \quad\text{or}\quad
      x = h_1^{-1}h_2yk_2k_1^{-1}\in HyK.
    \end{equation*}
    Since $x\in HyK$ we have $HxK\subseteq HyK$. A similar argument
    shows that $y\in HxK$ and $HyK\subseteq HxK$. Therefore
    $HxK = HyK$. This shows that two $HK$ double cosets are either
    disjoint or equal.

    Next, each $HK$ double coset $HxK$ is nonempty since
    $x = 1x1\in HxK$. This also shows that every element $x$ in $G$
    belongs to some $HK$ double coset. Therefore the set of $HK$
    double cosets partitions $G$.
  \end{proof}

\item Prove that $\ord{HxK} = \ord{K}\cdot\ord{H : H\cap xKx^{-1}}$.
  \begin{proof}
    We will assume that $H$ and $K$ are {\em finite} subsets of
    $G$. From the above, we know that $HxK$ is a union of left cosets
    of $K$,
    \begin{equation*}
      HxK = \bigcup_{i=1}^nx_iK.
    \end{equation*}
    Let $A = \{x_1K, \dots, x_nK\}$ and let $B$ be the set of cosets
    of $H\cap xKx^{-1}$ in $H$.

    We will define a map $\varphi\colon A\to B$ as follows. Given
    $x_jK\in A$, we can find $h\in H$ such that $hxK = x_jK$. Then
    define $\varphi(x_jK) = h(H\cap xKx^{-1})$.

    First we show that $\varphi$ is well defined. Suppose
    \begin{equation*}
      h_1xK = h_2xK \quad\text{for}\quad h_1,h_2\in H.
    \end{equation*}
    Then $h_1x$ and $h_2x$ belong to the same coset of $K$, so there is
    $k\in K$ with
    \begin{equation*}
      h_1x = h_2xk
      \quad\text{or}\quad
      h_2^{-1}h_1 = xkx^{-1}.
    \end{equation*}
    Hence $h_2^{-1}h_1\in H\cap xKx^{-1}$ so that $h_1$ and $h_2$
    belong to the same coset of $H\cap xKx^{-1}$, i.e.,
    \begin{equation*}
      h_1(H\cap xKx^{-1}) = h_2(H\cap xKx^{-1}),
    \end{equation*}
    and this shows that $\varphi$ is well defined.

    Next, we show that $\varphi$ is injective. Suppose
    $\varphi(h_1xK) = \varphi(h_2xK)$. Then
    $h_1(H\cap xKx^{-1}) = h_2(H\cap xKx^{-1})$ and there is a
    $k\in K$ such that
    \begin{equation*}
      h_2^{-1}h_1 = xkx^{-1},
    \end{equation*}
    or $h_1x = h_2xk$ and so $h_1x$ and $h_2x$ belong to the same
    coset of $K$. That is, $h_1xK = h_2xK$ and $\varphi$ is indeed an
    injection.

    And $\varphi$ is clearly surjective since given any coset
    $h(H\cap xKx^{-1})\in B$ we can take $hxK\in A$ so that
    $\varphi(hxK) = h(H\cap xKx^{-1})$ as required.

    We have shown that $\varphi$ is a bijection and it now follows
    that
    \begin{equation*}
      \ord{A} = \ord{B}.
    \end{equation*}
    However, we know that $\ord{A}$ is the number of cosets of $K$ in
    $HxK$, so that, by Lagrange's Theorem,
    \begin{equation*}
      \frac{\ord{HxK}}{\ord{K}}
      = \ord{HxK : K} = \ord{A}
      = \ord{B} = \ord{H : H\cap xKx^{-1}}.
    \end{equation*}
    This can be rearranged to get
    \begin{equation*}
      \ord{HxK} = \ord{K}\cdot\ord{H : H\cap xKx^{-1}}
    \end{equation*}
    as desired.
  \end{proof}

\item Prove that $\ord{HxK} = \ord{H}\cdot\ord{K : K\cap x^{-1}Hx}$.
  \begin{proof}
    We can use the same argument as above, only defining $\varphi$ as
    \begin{equation*}
      Hxk\mapsto (K\cap x^{-1}Hx)k.
    \end{equation*}
    This gives the necessary bijection between the right cosets of $H$
    in $HxK$ and the right cosets of $K\cap x^{-1}Hx$ in $K$.
  \end{proof}
\end{enumerate}
